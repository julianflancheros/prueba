<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <!-- <title>Portfolio Details TPi Web Page</title> -->
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/favicon.jpg" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,500,500i,600,600i,700,700i|Playfair+Display:400,400i,500,500i,600,600i,700,700i,900,900i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/ionicons/css/ionicons.min.css" rel="stylesheet">
    <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
    <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
    <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="assets/css/stylePorfolio.css" rel="stylesheet">

    <title>Portfolio Details</title>
    <script src="assets/js/test.js"></script>

    <!-- ESTILOS AGREGADOS PARA IFRAMES RESPONSIVOS -->
    <style>
        .mapUpper {
            padding-bottom: 50px;
        }

        /* Clase dinámica para cualquier iframe inyectado */
        .map-frame {
            width: 100%;        /* Ocupa todo el ancho disponible del contenedor padre */
            display: block;
            border: none;
            aspect-ratio: 16/9; /* Mantiene proporción panorámica */
            min-height: 400px;  /* Altura mínima para asegurar visibilidad en móviles */
        }
    </style>

    <script>
        function loadMedia(media) {
            const urlParams = new URLSearchParams(window.location.search);
            const projectKey = urlParams.get('project');
            // Asegurarse de que portfolioDetails esté definido (asumiendo que viene de test.js)
            const project = (typeof portfolioDetails !== 'undefined') ? portfolioDetails[projectKey] : null;

            let mediaContent = '';
            console.log(media.type)
            
            if (media.type === 'image') {
                mediaContent = `<div class="gallery">
                ${media.items.map(item => `
                    <div class="gallery-item">
                    <img src="${item.src}" alt="${item.alt}" class="img-fluid">
                    <a href="${item.src}" data-gall="portfolioGallery" class="venobox" title="${item.alt}"><i class="icofont-plus"></i></a>
                    </div>
                `).join('')}
            </div>`;
            } else if (media.type === 'video') {
                mediaContent = `
                                <video controls class="img-fluid">
                                    <source src="${media.src}" type="video/${media.format}">
                                    Your browser does not support the video tag.
                                </video>
                            `;
            } else if (media.type === 'url') {
                mediaContent = `${media.items.map(item => `${item.src}`).join('')}`;
            } 
            // === NUEVA OPCIÓN PARA IFRAMES ===
            else if (media.type === 'iframe') {
                // Asumimos que media.items es un array de objetos con { src: "url" }
                mediaContent = media.items.map(item => `
                    <div class="row mapUpper">
                        <iframe class="map-frame" src="${item.src}" allowfullscreen></iframe>
                    </div>
                `).join('');
            }
            
            console.log(mediaContent);
            return mediaContent;
        }

        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const projectKey = urlParams.get('project');
            
            // Verificación de seguridad por si portfolioDetails no cargó
            if (typeof portfolioDetails === 'undefined') {
                console.error("portfolioDetails no está definido. Revisa assets/js/test.js");
                return;
            }

            const project = portfolioDetails[projectKey];
            if (project) {
                document.title = "Portfolio Details - " + project.description;
                if(document.getElementById("section-title")) document.getElementById("section-title").innerText = portfolioDetails.title || "Portfolio Details";
                if(document.getElementById("section-description")) document.getElementById("section-description").innerText = project.description;
                if(document.getElementById("breadcrumbs")) document.getElementById("breadcrumbs").innerHTML = project.description;
                
                // Cargar Medios
                if(document.getElementById("portfolio-details-container")) document.getElementById("portfolio-details-container").innerHTML = loadMedia(project.media);

                const infoBox = `
                <div class="info-box">
                    <h3>Basic Information Project</h3>
                    <ul>
                        <li><strong>Client</strong>: ${project.summary[0].client}</li>
                        <li><strong>Project date</strong>: ${project.summary[1].date}</li>
                        <li><strong>Final and Active Url</strong>: <a href="${project.summary[2].url}" target="_blank">${project.summary[2].url}</a></li>
                    </ul>
                </div>
            `;

                if(document.getElementById("summary")) document.getElementById("summary").innerHTML = infoBox;
                if(document.getElementById('description-content')) document.getElementById('description-content').innerHTML = project.projectDescription;
                
                const skillsContent = document.getElementById('skills-content');
                if (skillsContent) {
                    skillsContent.innerHTML = '';
                    let row;
                    project.skills.forEach((skill, index) => {
                        if (index % 8 === 0) {
                            row = document.createElement('div');
                            row.className = 'row';
                            skillsContent.appendChild(row);
                        }
                        const skillElement = document.createElement('div');
                        skillElement.className = 'col-lg-3 col-md-4 mt-4';
                        skillElement.innerHTML = `
                        <div class="interests">
                            <div class="icon-box">
                                <i class="icofont-architecture-alt" style="color: #18d26e;"></i>
                                <h3>${skill}</h3>
                            </div>
                        </div>`;
                        row.appendChild(skillElement);
                    });
                }
            }
            else {
                window.location.href = "404.html";
            }
        });
    </script>
</head>

<body>
    <!-- ======= Navbar ======= -->
    <nav id="main-nav" class="subpage-nav">
        <div class="row">
            <div class="container">

                <div class="logo">
                    <h1><a href="/" data-section="busineesCard" data-value="name">Julian F. Lancheros</a></h1>
                </div>

                <div class="responsive"><i data-icon="m" class="ion-navicon-round"></i></div>

                <ul class="nav-menu-PorfolioDetails list-unstyled">
                    <li><a href="index.html" class="smoothScroll">Home</a></li>
                    <li><a href="index.html#about" class="smoothScroll">About</a></li>
                    <li><a href="index.html#qualification" class="smoothScroll">qualification</a></li>
                    <li><a href="index.html#portfolio" class="smoothScroll">Portfolio</a></li>
                    <li><a href="index.html#contact" class="smoothScroll">Contact</a></li>
                </ul>

            </div>
        </div>
    </nav><!-- End Navbar -->

    <main id="main">
        <!-- ======= Breadcrumbs Section ======= -->
        <section class="breadcrumbs">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="section-title">
                        <h2 id="section-title"></h2>
                        <p id="section-description"></p>
                    </div>

                    <ol>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="index.html#portfolio">Portfolio</a></li>
                        <li id="breadcrumbs"></li>
                    </ol>
                </div>

                <div id="portfolio-details-container"></div>
                <!-- El contenedor ya tiene la clase CSS necesaria inyectada por JS si es un iframe -->

                <div id="summary"></div>
                <br /><br />
                <p id="description-content"></p>
                <div id="skills-content"></div>
            </div>
        </section>
    </main>

    <!-- ======= Footer ======= -->
    <!-- <div id="footer" class="text-center">
        <div class="container">

            <small><span>Developed and designed by&nbsp;</span><a
                    href='mailto:julianflancheros@gmail.com'>Julianflancheros</a>. &copy;
                <script type="text/javascript">
                    var d = new Date()
                    document.write(d.getFullYear())
                </script><span class="min-footer">. All rights reserved.</span>
            </small>

        </div>
    </div> -->
    <!-- End Footer -->

    <!-- Back to top-->
    <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

    <!-- Theme change button-->
    <a href="#" class="change-theme">
        <i class="icofont-sun-alt" id="theme-button"></i>
    </a>

    <div class="credits">
        <small>
            <span>Developed and designed by&nbsp;</span><a
                    href='mailto:julianflancheros@gmail.com'>Julianflancheros</a>. &copy;
                <script type="text/javascript">
                    var d = new Date()
                    document.write(d.getFullYear())
                </script>
                <span class="min-footer">. All rights reserved.</span>
        </small>
    </div>

</body>
<!-- Vendor JS Files -->
<script src="assets/vendor/jquery/jquery.min.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/vendor/jquery-sticky/jquery.sticky.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/venobox/venobox.min.js"></script>
<script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>

<!-- Template Main JS File -->
<!-- <script src="assets/js/main.js"></script> -->
<script src="assets/js/mainPorfolio.js"></script>
<script src="assets/js/language.js"></script>

</html>